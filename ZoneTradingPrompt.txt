TI-2 - duplicate zones removal
Update the code
If two zones of the same timeframe overlap,leave only the earliest one i.e. the one that has the earliest leg-in remove the others

Mark code with the user story TI-2
No other changes to the code!!!Never change the name of the indicator!!!


TI-5 Nested zone strategy

/*
Update the code
Once the pice comes to a zone, check if the zone is within another zone of the same type (supply or demand respectively). 
If yes , then 
    If demand zone - take long, stoploss below the zone at 30% of the zone height. TP at the nearest supply zone above but not closer than 1R
    If supply zone - take short, stoploss above the zone at 30% of the zone height. TP at the nearest demand zone below but not closer than 1R

Mark code with the user story TI-5
No other changes to the code!!!Never change the name of the indicator!!!


*/

Update the code
convert the indicator to a strategy
Once the pice arrives to a zone, check if the zone is within another zone of the same type (supply or demand respectively).
Arrives means: the candle crosses the zone boundary 
for demand the candle high is outside the zone and low is inside the Zone
for supply the candle low is outside the zone and the high is inside the zone

If yes , then 
    If demand zone - take long, stoploss below the zone at 30% of the zone height. TP at 2R
    If supply zone - take short, stoploss above the zone at 30% of the zone height. TP at 2R

Dont make any labels, generate a buy or sell order. 
Also generate alert on entry with the text: "Price entered a nested supply/demand zone"

Change teh code below
Mark changes with the user story ID TI-5
No other changes to the code!!!
Never change the name of the indicator!!!

===================================================================
/*
//TI-6 - Retracement to the zone within trend strategy

Update the code
convert the indicator to a strategy

If there is a downtrend 
and the price revisits a supply zone, meaning a green candle has (high is above  the zone and close below or within the zone) OR (close within the zone)
then 
    enter short,
    SL above the zone at 30% of the zone height
    TP at 2R
  
If there is an uptrend 
and the price revisits a demand zone, meaning a red candle has (low is below  the zone and close above or within the zone) OR (close within the zone)
then 
    enter long,
    SL below the zone at 30% of the zone height
    TP at 2R

Dont make any labels, generate a buy or sell order. 
Also generate alert on entry with the text: "Price retraced to a zone"

Use the code below as teh starting point!!!
Mark changes with the user story ID TI-6
No other changes to the code!!!
Never change the name of the indicator!!!



//TI-6 - Retracement to the zone within trend strategy

Update the code
convert the indicator to a strategy

If there is a downtrend 
and the price revisits a supply zone, meaning a green candle has high or close within the zone
then 
    enter short,
    SL above the zone at 30% of the zone height
    TP at 2R
  
If there is an uptrend 
and the price revisits a demand zone, meaning a red candle has low or close within the zone
then 
    enter long,
    SL below the zone at 30% of the zone height
    TP at 2R

Evaluate revisiting the zones only for the candles on the current timeframe but take in consideration zones on all relevant timeframes
Make sure the entries are generated only when the price touches the zone or closes inside the zone. 
Entries outside the zone are not allowed!!!!

Dont make any labels, generate a buy or sell order. 
Also generate alert on entry with the text: "Price retraced to a zone"



Use the code below as teh starting point!!!
Mark changes with the user story ID TI-6
No other changes to the code!!!
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!
*/
=============================
/*

//TI-6 - Retracement to the zone within trend strategy

Update the code
convert the indicator to a strategy

If there is a downtrend 
and the price revisits a supply zone, meaning a green candle has high or close within the zone
then 
    enter short,
    SL above the zone at 30% of the zone height
    TP at 2R
  
If there is an uptrend 
and the price revisits a demand zone, meaning a red candle has low or close within the zone
then 
    enter long,
    SL below the zone at 30% of the zone height
    TP at 2R

Evaluate revisiting the zones only for the candles on the current timeframe but take in consideration zones on all relevant timeframes
Make sure the entries are generated only when the price touches the zone or closes inside the zone. 
Entries outside the zone are not allowed!!!!

Dont make any labels, generate a buy or sell order. 
Also generate alert on entry with the text: "Price retraced to a zone"



Use the code below as teh starting point!!!
Mark changes with the user story ID TI-6
No other changes to the code!!!
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!
*/

===================================================================== 
//TI-6 - Retracement to the zone within trend strategy
// Just double zones , no trends

Update the code
convert the indicator to a strategy

If the price revisits a supply zone, meaning a green candle has high inside the zone and low outside the zone
and the zone is contained in another supply zone
and the zone does not contain any zones inside
then 
    enter short,
    SL above the zone at 30% of the zone height
    TP at 2R
  
If the price revisits a demand zone, meaning a red candle has low inside the zone and high outside the zone
and the zone is contained in another supply zone
and the zone does not contain any zones inside
then 
    enter long,
    SL below the zone at 30% of the zone height
    TP at 2R

Evaluate revisiting the zones only for the candles on the current timeframe but take in consideration zones on all relevant timeframes
Make sure the entries are generated only when the price touches the zone or closes inside the zone. 
Entries outside the zone are not allowed!!!!

Dont make any labels, generate a buy or sell order. 
Also generate alert on entry with the text: "Price retraced to a zone"



Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Mark changes with the user story ID TI-6
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
never name functions after the user story ID like TI-6, TI-2.... give them meaningful names!
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!


==================================================


When the price arrives to a zone and rejects from a zone, with a candle about 0.5 ATR (setting in UI) send an alert:
Price of <ticker> rejected from the level ..... <the rejection level>   
Mark the rejection as potial entry: green "B" for long, red "S" for short


Mark the changes with user story ID: TI-7 

Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Mark changes with the user story ID TI-6
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
never name functions after the user story ID like TI-6, TI-2.... give them meaningful names!
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!


===========================

UPdate code You dont markt the "rejection" that formed the zone, only the subsequent rejections. I.e. if the rejection candle is the legout - dont mark it as a rejection. also put the "main()" function at the bottom of the script


Update the code markonly the cases when the price revisited the zone and left the zone with a strong move at least 0.5 atr (UI setting) . 
DO not mark if the price remains within the zone - it shoul leave the zone with a strong move or just touch the zone with the minimum or maximum of the candle.


Mark the changes with user story ID: TI-7 

Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Mark changes with the user story ID TI-6
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
never name functions after the user story ID like TI-6, TI-2.... give them meaningful names!
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!



============================== 


Remove the TI-7 label from the UI
MAke a setting: Alert on zone depature. Bool, default OFF 
Trigger the allerts and show the B and S labels only if the alerts are ON


Mark the changes with user story ID: TI-7 

Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Mark changes with the user story ID TI-6
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
never name functions after the user story ID like TI-6, TI-2.... give them meaningful names!
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!




============================== 


Change the zones colors:
SUpply - red, Demand - green

Mark the changes with user story ID: TI-7 

Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Mark changes with the user story ID TI-6
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
never name functions after the user story ID like TI-6, TI-2.... give them meaningful names!
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!


============================== 


Update the script below turn it into a strategy. 

Go long when you generate B, stoploss below the zone from where the price rejected -30% (common setting for all stoplosses)
Take profit - at the bottom of the next available supply zone above

Go whort when you generate S, stoploss above the zone from where the price rejected +30% (common setting for all stoplosses)
Take profit - at the top of the next available demand zone below

Mark the changes with user story ID: TI-9 

Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Mark changes with the user story ID TI-6
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
never name functions after the user story ID like TI-6, TI-2.... give them meaningful names!
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!



============================== 


Update the script below turn it into a strategy. 


Go LONG when 
the price makes a strong long move of size  (Rejection Candle Min Body (xATR) setting)  from a demand zone - no matter if the zone is revisited or newly formed
stoploss below the zone from where the price rejected -30% (common setting for all stoplosses)
Take profit  or exit - when there is a srong short move (use Rejection Candle Min Body (xATR) setting) - not at the previous zone 


Go SHORT when the price makes a strong short move of size ( Rejection Candle Min Body (xATR) setting)  from a supply zone - no matter if the zone is revisited or newly formed
stoploss above the zone from where the price rejected +30% (common setting for all stoplosses)
Take profit or exit  - when there is a srong long move (use Rejection Candle Min Body (xATR) setting)

Mark the changes with user story ID: TI-9 

Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Mark changes with the user story ID TI-6
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
never name functions after the user story ID like TI-6, TI-2.... give them meaningful names!
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!



============================== 


Update the script below turn it into a strategy. 


Go LONG when 
EMA 20 is over EMA50
THe price is in a demand zone close to EMA20 within (Rejection Candle Min Body (xATR) setting), makes strong move UP  (Rejection Candle Min Body (xATR) setting)
stoploss below the zone from where the price rejected -30% (common setting for all stoplosses)
Take profit  or exit - when there is a srong short move (use Rejection Candle Min Body (xATR) setting) - not at the previous zone 


Go SHORT when 
EMA 20 is under EMA50
THe price is in a supply zone close to EMA20 within (Rejection Candle Min Body (xATR) setting) , makes strong move DOWN (Rejection Candle Min Body (xATR) setting)
stoploss above the zone from where the price rejected +30% (common setting for all stoplosses)
Take profit or exit  - when there is a srong long move (use Rejection Candle Min Body (xATR) setting)

Mark the changes with user story ID: TI-9 

Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Never use user story ide to name functions variables and other identifiers!!!! it is only for comments!!!
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
never name functions after the user story ID like TI-6, TI-2.... give them meaningful names!
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!


=================================
//v20
//Did not work - negative profit

Go LONG when 
THe price is in a demand zone or touches the demand zone with its low
The height of the zone is within (Rejection Candle Min Body (xATR) setting)
stoploss below the zone from where the price rejected -30% (common setting for all stoplosses)
EITHER:
    There is no supply zones above within at least 2R (setting Stoploss distance from zone)
OR
    There is an Uptrend - EMA20 is above EMA50
Take profit - at the next supply zone
Move stoploss to Break even when the price has passed 50% to the target 

Go SHORT when 
THe price is in a supply zone or touches the supply zone with its high
The height of the zone is within (Rejection Candle Min Body (xATR) setting)
stoploss above the zone from where the price rejected +30% (common setting for all stoplosses)
EITHER
    There is no demand zones below within at least 1R (setting Stoploss distance from zone)
OR 
    There is a Downtrend - EMA20 is below EMA50
Take profit - at the next demand zone
Move stoploss to Break even when the price has passed 50% to the target 

Mark the changes with user story ID: TI-9 

Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Never use user story ide to name functions variables and other identifiers!!!! it is only for comments!!!
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
Never use the functions that are not in the standard library, like math.inf
never name functions after the user story ID like TI-6, TI-2.... give them meaningful names!
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!



=================================
//TI-10
//Check freshness of the zone max 2 touches allowed

update the script
Before generating B or S check freshness of the zone;
If at least 2 (Setting  Max zone touches) B were already generated in the same demand zone
or at least 2 (Setting  Max zone touches) S were already generated in the same supply zone 
then do not generate any more B or S in the same zone - it is considered not fresh any more



Mark the changes with user story ID: TI-10

DO NOT CHANGE ZONE DRAWING LOGIC!!!! the change effects only showing of the B and S!!!
Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Never use user story ide to name functions variables and other identifiers!!!! it is only for comments!!!
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
Never use the functions that are not in the standard library, like math.inf
never name functions after the user story ID like TI-6, TI-2.... give them meaningful names!
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!




=================================
//TI-10
//Check freshness of the zone max 2 touches allowed

Go LONG when 
EMA 20 is over EMA50
THe price is in a demand zone close to EMA20 within (Rejection Candle Min Body (xATR) setting), makes strong move UP  (Rejection Candle Min Body (xATR) setting)
stoploss below the zone from where the price rejected -30% (common setting for all stoplosses)
Take profit  or exit - when there is a srong short move (use Rejection Candle Min Body (xATR) setting) - not at the previous zone 


Go SHORT when 
EMA 20 is under EMA50
THe price is in a supply zone close to EMA20 within (Rejection Candle Min Body (xATR) setting) , makes strong move DOWN (Rejection Candle Min Body (xATR) setting)
stoploss above the zone from where the price rejected +30% (common setting for all stoplosses)
Take profit or exit  - when there is a srong long move (use Rejection Candle Min Body (xATR) setting)


Mark the changes with user story ID: TI-9s

Use the code below as the starting point!!!
IMPORTANT!!! Dont do any other changes!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Never use user story ide to name functions variables and other identifiers!!!! it is only for comments!!!
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
Never use the functions that are not in the standard library, like math.inf
never name functions after the user story ID like TI-6, TI-2.... give them meaningful names!
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!




=================================
//TI-9
//Convert to strategy

Enter Long position when B alert is generated.
stoploss below the zone at 30% of the zone size (setting Stoploss distance percent of zone size) 
Exit position when reached supply zone of the same level (M1, M15, M15... ) as the demand zone from where the price rejected
when a short entry conditions fulfilled exit the position and open the short one

Enter Short position when S alert is generated.
stoploss above the zone at 30% of the zone size (setting Stoploss distance percent of zone size) 
Exit position when reached demand zone of the same level (M1, M15, M15... ) as the supply zone from where the price rejected
 when a long entry conditions fulfilled close the position and open the long one


Mark each entry with YYYYMMDDHHMISS.SSS   mark each position exit with the same ID as corresponding entry
NO OTHER LABELS EXCEPT FOR THE B and S !!!!!


Generate B emtry when the price has formed a demand zone and departed with a strong caldne (Rejection candle min body) close Short position if exists and open Long
Generate S emtry when the price has formed a supply zone and departed with a strong caldne (Rejection candle min body) close Long position if exists and open short

Mark the changes with user story ID: TI-9


Use the code below as the starting point!!!
IMPORTANT!!! Dont do any other changes!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Never use user story ide to name functions variables and other identifiers!!!! it is only for comments!!!
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
Never use the functions that are not in the standard library, like math.inf
never name functions after the user story ID like TI-6, TI-2.... give them meaningful names!
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!


=================================
//TI-11 preferred and extended version of the zone
1
update the script
For demand zone identify upper boundary as follows:
If the Checkbox "Use extended version of the zone" is checked then the upper bound of the zone is 



Mark the changes with user story ID: TI-10

Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Never use user story ID like TI-1, TI-2 or whatever to name functions variables and other identifiers!!!! it is only for comments!!! 
Use clean identifier names that have business meaning!!!
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
Never use the functions that are not in the standard library, like math.inf
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!




=================================
//TI-14 (prev TI-12) engoulding on rejection

update the script
Add the following condition for B:
if the strong green candle departing the zone follows a red candle , it must engulf it

Add the following condition for S:
if the strong green candle departing the zone follows a red candle , it must engulf it


Mark the changes with user story ID: TI-10

Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Never use user story ID like TI-1, TI-2 or whatever to name functions variables and other identifiers!!!! it is only for comments!!! 
Use clean identifier names that have business meaning!!!
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
Never use the functions that are not in the standard library, like math.inf
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!




=================================
//TI-3 EMA as a confluence

update the script

Assume EMA_FAST = EMA50 (EMA length is a setting)
Assume EMA_SLOW = EMA100 (EMA length is a setting)

Enter LONG when
EMA_FAST is above EMA_SLOW
The price shows a green candle starting within a demand zone 
The size of the candle is minimum  (Rejection Candle Min Body (xATR) setting)
EMA_FAST or EMA_SLOW is in the same demand zone
Stoploss below the demand zone - 30% of the zone size (setting Stoploss distance percent of zone size) 
Takeprofit R3


EMA_FAST is below EMA_SLOW.

Price prints a red candle that starts within a supply zone (open inside the zone).
The candle’s body is ≥ Rejection Candle Min Body (× ATR).
EMA_FAST or EMA_SLOW is inside the same supply zone.
Stop-loss: above the supply zone by 30% of the zone height (Stoploss distance percent of zone size).
Take-profit: R3 (3× the entry-to-stop distance).

Risk management: 
Stoploss to breakeven when 1R reached
Visualize the entry with the dark green rectange beween entry and TO, purple rectange between entry and SL - standard represnetation in TradingView



Add the following condition for S:
if the strong green candle departing the zone follows a red candle , it must engulf it


Mark the changes with user story ID: TI-3

Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Never use user story ID like TI-1, TI-2 or whatever to name functions variables and other identifiers!!!! it is only for comments!!! 
Use clean identifier names that have business meaning!!!
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
Never use the functions that are not in the standard library, like math.inf
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!
Dont make newline between function arguments
Dont modify global vriables inside a function




REJECTION FROM EMA20/50/100 IS A PRIO!!! 

ZONE INVALIDATION IS A PRIO!!!!!



=================================
//TI-18 Alerts when price rejects from the zone with volumes

update the script

Ensure the alert is generated when and only when there is a B or S sign appeared



Mark the changes with user story ID in the comment above

Use the code below as the starting point!!!
IMPORTANT!!! Any other changes to the code except for the requested ones are strongly prohibited!!!
Never use user story ID like TI-1, TI-2 or whatever to name functions variables and other identifiers!!!! it is only for comments!!! 
Use clean identifier names that have business meaning!!!
Never change the name of the indicator!!!
The code you generate must be syntactycally correct pinescript , compile without errors
Never use the functions that are not in the standard library, like math.inf
DOUBLE CHECK THE SYNTACTICAL CORRECTNESS!!!!
Dont make newline between function arguments
Dont modify global vriables inside a function




REJECTION FROM EMA20/50/100 IS A PRIO!!! 

ZONE INVALIDATION IS A PRIO!!!!!
